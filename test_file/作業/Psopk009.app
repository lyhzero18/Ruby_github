.head 0 +  Application Description: ---------------------------------------------------------------
     ÇoÇqÇnÅ|ÇrÇsÇ`ÇeÇe  ããó^       Copyright(C)   1993-2007
                                    ÉAÉCÉeÉbÉNÉXäîéÆâÔé–
                                    All rights reserved
                                    
---------------------------------------------------------------
Åy ÇhÇc Åz	PSOPK009.APP
Åy ã@î\ Åz	PL/SQLîƒópåƒèo
ÅyçÏê¨é“Åz	ITECS
ÅyçÏê¨ì˙Åz	1999/06/17
ÅyïœçXì˙Åz	2011/02/10	PL/SQLé¿çså„ÅApgmåƒÇ—èoÇ∑ã@î\Çí«â¡
---------------------------------------------------------------
.head 1 -  Outline Version - 4.0.31
.head 1 +  Design-time Settings
.data VIEWINFO
0000: 6F00000001000000 FFFF01000D004347 5458566965775374 6174650400010000
0020: 0000000000B70000 002C000000020000 0003000000FFFFFF FFFFFFFFFFF8FFFF
0040: FFE1FFFFFF000000 0000000000F40300 00E0000000010000 0001000000010000
0060: 000F4170706C6963 6174696F6E497465 6D00000000
.enddata
.data DT_MAKERUNDLG
0000: 00000000000C5073 6F706B3030392E65 78650C50736F706B 3030392E646C6C0C
0020: 50736F706B303039 2E61706300000101 011E433A5C407072 6F6A6563745C4150
0040: 4C33325C50736F70 6B3030392E72756E 1E433A5C4070726F 6A6563745C41504C
0060: 33325C50736F706B 3030392E646C6C1E 433A5C4070726F6A 6563745C41504C33
0080: 325C50736F706B30 30392E6170630000 0101011E433A5C40 70726F6A6563745C
00A0: 41504C33325C5073 6F706B3030392E61 70641E433A5C4070 726F6A6563745C41
00C0: 504C33325C50736F 706B3030392E646C 6C1E433A5C407072 6F6A6563745C4150
00E0: 4C33325C50736F70 6B3030392E617063 00000101011E433A 5C4070726F6A6563
0100: 745C41504C33325C 50736F706B303039 2E61706C1E433A5C 4070726F6A656374
0120: 5C41504C33325C50 736F706B3030392E 646C6C1E433A5C40 70726F6A6563745C
0140: 41504C33325C5073 6F706B3030392E61 70630000010101
.enddata
.head 2 -  Outline Window State: Maximized
.head 2 +  Outline Window Location and Size
.data VIEWINFO
0000: 6600040003001B00 0200000000000000 0000112969150500 1D00FFFF4D61696E
0020: 001E000100000000 0000000000F51E0F 0D0000F400FFFF43 6C61737365730029
0040: 0001000000000000 000000F51E860A00 008600FFFF496E74 65726E616C204675
0060: 6E6374696F6E7300 2000010000000000 00000000AD28A416 0000DF00FFFF5661
0080: 726961626C657300
.enddata
.data VIEWSIZE
0000: 8800
.enddata
.head 3 -  Left: -0.013"
.head 3 -  Top: 0.0"
.head 3 -  Width:  8.013"
.head 3 -  Height: 4.972"
.head 2 +  Options Box Location
.data VIEWINFO
0000: 0038B80BB80B2500
.enddata
.data VIEWSIZE
0000: 0800
.enddata
.head 3 -  Visible? Yes
.head 3 -  Left: 4.15"
.head 3 -  Top: 1.889"
.head 3 -  Width:  3.8"
.head 3 -  Height: 2.074"
.head 2 +  Class Editor Location
.head 3 -  Visible? No
.head 3 -  Left: 0.025"
.head 3 -  Top: 1.148"
.head 3 -  Width:  5.988"
.head 3 -  Height: 1.843"
.head 2 +  Tool Palette Location
.head 3 -  Visible? No
.head 3 -  Left: 1.425"
.head 3 -  Top: 0.417"
.head 2 -  Fully Qualified External References? No
.head 2 -  Reject Multiple Window Instances? No
.head 2 -  Enable Runtime Checks Of External References? No
.head 2 -  Use Release 4.0 Scope Rules? No
.head 1 +  Libraries
.head 2 -  ! File Include: IME.APL
.head 2 -  ! Å§2011/02/10
.head 2 -  File Include: PST_Access.apl
.head 2 -  ! Å¢2011/02/10
.head 2 -  File Include: psfunk01.apl
.head 2 -  ! File Include: myovlib.apl
.head 2 -  File Include: VT.APL
.head 2 -  ! File Include: SQLERROR.APL
.head 2 -  File Include: PST_CERTIFY.APL
.head 2 -  ! 2020
.head 2 -  File Include: PST_Date.APL
.head 2 -  ! 2020
.head 1 +  Global Declarations
.head 2 +  Window Defaults
.head 3 +  Tool Bar
.head 4 -  Display Style? Etched
.head 4 -  Font Name: ÇlÇr ÉSÉVÉbÉN
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Form Window
.head 4 -  Display Style? Etched
.head 4 -  Font Name: ÇlÇr ÉSÉVÉbÉN
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Dialog Box
.head 4 -  Display Style? Etched
.head 4 -  Font Name: ÇlÇr ÉSÉVÉbÉN
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Top Level Table Window
.head 4 -  Font Name: ÇlÇr ÉSÉVÉbÉN
.head 4 -  Font Size: System Default
.head 4 -  Font Enhancement: None
.head 4 -  Text Color: System Default
.head 4 -  Background Color: System Default
.head 3 +  Data Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Multiline Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Spin Field
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Background Text
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Pushbutton
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Radio Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Check Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Option Button
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 3 +  Group Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Child Table Window
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  List Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Combo Box
.head 4 -  Font Name: Use Parent
.head 4 -  Font Size: Use Parent
.head 4 -  Font Enhancement: Use Parent
.head 4 -  Text Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Line
.head 4 -  Line Color: Use Parent
.head 3 +  Frame
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 3 +  Picture
.head 4 -  Border Color: Use Parent
.head 4 -  Background Color: Use Parent
.head 2 +  Formats
.head 3 -  Number: 0'%'
.head 3 -  Number: #0
.head 3 -  Number: ###0
.head 3 -  Number: ###000
.head 3 -  Number: ###000;'($'###000')'
.head 3 -  Date/Time: yy-MM-dd
.head 3 -  Date/Time: yyyy-MM-dd
.head 3 -  Date/Time: ED
.head 3 -  Date/Time: E
.head 3 -  Date/Time: yy-MM-dd hhhh:mm
.head 3 -  Date/Time: yyyy-MM-dd hhhh:mm
.head 3 -  Date/Time: hh:mm:ss AMPM
.head 3 -  Date/Time: M/d/yy
.head 3 -  Date/Time: MM-dd-yy
.head 3 -  Date/Time: dd-MMM-yyyy
.head 3 -  Date/Time: MMM d, yyyy
.head 3 -  Date/Time: MMM d, yyyy hh:mm AMPM
.head 3 -  Date/Time: MMMM d, yyyy hh:mm AMPM
.head 3 -  Number: ##000
.head 3 -  Number: 00000
.head 2 +  External Functions
.head 3 -  ! Å§2011/02/10
.head 3 +  Library name: KERNEL32.DLL
.head 4 -  ThreadSafe: No
.head 4 +  Function: GetComputerNameA
.head 5 -  Description: ÉRÉìÉsÉÖÅ[É^ñºÇÃéÊìæ
.head 5 -  Export Ordinal: 0
.head 5 +  Returns
.head 6 -  Boolean: BOOL
.head 5 +  Parameters
.head 6 -  Receive String: LPSTR
.head 6 -  Receive Number: LPLONG
.head 3 -  ! Å¢2011/02/10
.head 2 +  Constants
.data CCDATA
0000: 3000000000000000 0000000000000000 00000000
.enddata
.data CCSIZE
0000: 1400
.enddata
.head 3 +  System
.head 3 +  User
.head 4 -  ! ! ! 1999/01/04 í«â¡
.head 3 -  Enumerations
.head 2 -  Resources
.head 2 +  Variables
.data RESOURCE 0 0 1 2607109770
0000: DC040000FE010000 0000000000000000 0200002400000024 0100001004000000
0020: 020000FE00FFA328 010004B5000200FF FF082C0100190000 00ED0400FF3F4501
0040: 5A00040002FB00FF 8F49010096190001 00FE00FFA3620100 04A10001020000FF
0060: 078001000000FF68 6601000400EE0100 FFC9800100003F6A 019A00040001FB00
0080: 7F80F20100008F6E 0100E6040001FE00 9F8001FC0000A372 010004B9000100FF
00A0: 2780010000FF6876 01001900E9010000 FF3F8F011A000400 0102FB007F80F201
00C0: 00008F930100E604 0001FE009F8001FC 0000A397010004B9 000100FF27800100
00E0: 00FF689B01000400 EE0100FFC9800100 003F9F019A000400 01FB007F80F20100
0100: 008FA30100961900 0100FE00FFA3BC01 0004B5000200FFFF 68C001000400EC01
0120: 0200FFC980010000 3FC4019A00040001 FB007F80F2010000 8FC80100E6040001
0140: FE009F8001FC0000 A3CC010004B90001 00FF2780010000FF 68D001000400EE01
0160: 00FFC9800100003F D4015A00190001FA 0000FF8FED0100D6 190001FE00FFA306
0180: 020019B5000100FF FF681F02001900ED 0100FF3F38025A00 190001FB00FF8F51
01A0: 0200D6190001FE00 FFA36A020004B100 010200FF27800100 00FF686E02000400
01C0: EE0100FFC9800100 003F72029A000400 01FB007F80F20100 008F760200E60400
01E0: 01FE009F8001FC00 00A37A020004B900 0100FF2780010000 FF687E02001900E9
0200: 010000FF3F97025A 00190001FB00FF0F
.enddata
.head 3 -  ! Å§2011/02/10
.head 3 -  String: GsPGID
.head 3 -  String: GsAutoApp[*]
.head 3 -  String: GsAppParam[*]
.head 3 -  String: GsCallPgid[*]
.head 3 -  Number: GnAppCnt
.head 3 -  ! ÉAÉNÉZÉXÉçÉOóp
.head 3 -  String: GsUSER
.head 3 -  Sql Handle: PhSql
.head 3 -  ! Å¢2011/02/10
.head 3 -  ! 1999/06/14
.head 3 -  String: sPLSQL
.head 3 -  String: sTITLE
.head 3 -  ! SqlFetchNextÇÃïœêî
.head 3 -  ! Number: nFetch
.head 3 -  ! Boolean: bFetchOk 
.head 3 -  String: sWSID
.head 3 -  ! ÉJÉEÉìÉgïœêî
.head 3 -  ! Number: nCount 
.head 3 -  ! 1999/04/21 í«â¡
.head 3 -  Window Handle: hWindowHandle
.head 3 -  Number: nDebug
.head 3 -  Boolean: bActItem
.head 2 +  Internal Functions
.head 3 -  ! Å§2011/02/10
.head 3 +  Function: F_AutoAppSet
.head 4 -  Description: ÉpÉâÉÅÅ[É^Ç…ìoò^Ç≥ÇÍÇƒÇ¢ÇÈpgmÇïœêîÇ…ÉZÉbÉg
.head 4 +  Returns
.head 5 -  Number:
.head 4 -  Parameters
.head 4 -  Static Variables
.head 4 +  Local variables
.head 5 -  Number: nArryaCnt
.head 5 -  Number: nAppCnt
.head 4 +  Actions
.head 5 -  Set nArryaCnt = 6
.head 5 -  Set nAppCnt = 0
.head 5 +  Loop
.head 6 +  If strArgArray[nArryaCnt] = '' or strArgArray[nArryaCnt] = '0'
.head 7 -  Break
.head 6 -  Set GsAutoApp[nAppCnt] = strArgArray[nArryaCnt]
.head 6 -  Set GsAppParam[nAppCnt] = strArgArray[nArryaCnt+1]
.head 6 -  Set GsCallPgid[nAppCnt] = SalStrLeftX( GsAutoApp[nAppCnt], SalStrLength( GsAutoApp[nAppCnt] ) - 4 )
.head 6 -  Set nArryaCnt = nArryaCnt + 2
.head 6 -  Set nAppCnt = nAppCnt + 1
.head 5 -  Return nAppCnt
.head 3 -  ! Å¢2011/02/10
.head 2 +  Named Menus
.head 2 +  Class Definitions
.data RESOURCE 0 0 1 3760730002
0000: 41040000E1010000 0000000000000000 0200000500FFFF01 00160000436C6173
0020: 73566172004F7574 6C696E6552006567 496E666F13013800 00000F6300446573
0040: 6B746F704C006973 74426F784E01C200 0B00000043190000 0001FA0000FF6F19
0060: 00D6190001FE00FF 833200000019B500 0100FFFF604B0000 001900ED0100FF3F
0080: 6400580000190001 FB00FF0F7D000000 D6190001FE00FF83 9600000019B50001
00A0: 00FFFF60AF000000 1900ED0100FF3FC8 00580000190001FB 00FF0FE1000000D6
00C0: 190001FE00FF83FA 00000019B5000100 FFFF100180640000 010001000B634469
00E0: 724C3E697C00C000 00040000005B1900 01FB00FF6F1900D6 190001FE00FF9B32
0100: 0019B5000100FFFF 664B001900ED0100 FF3F0180044B0000 020000001E0F5472
0120: 65F8654C69005E00 0000030000006F19 00E9010000FFBF19 5900190001FB00FF
0140: 6F3200D6190001FE 00FF430180AF0000 0603000C634669F8 6C654C01D6000000
0160: 070000DE0019D200 010000FF7F19B300 1900F60100FFDF32 AC00190001FD00FF
0180: 374B00196B000100 FFFFCD640019DA00 0100FF7F7DB30019 00F60100FFDF96AC
01A0: 00190001FD00FF87 01807D000C000400 0D6352C06164696F 4C69079A00000005
01C0: 790000194B000100 00FFFFCD190019DA 000100FF7F32B300 1900F60100FFDF4B
01E0: AC00190001FD00FF 376400196B000100 FFFF01
.enddata
.head 2 +  Default Classes
.head 3 -  MDI Window: cBaseMDI
.head 3 -  Form Window: CfrmMain
.head 3 -  Dialog Box:
.head 3 -  Table Window:
.head 3 -  Quest Window:
.head 3 -  Data Field: CdfDisStr
.head 3 -  Spin Field:
.head 3 -  Multiline Field:
.head 3 -  Pushbutton:
.head 3 -  Radio Button: CrbBase
.head 3 -  Option Button:
.head 3 -  ActiveX:
.head 3 -  Check Box:
.head 3 -  Child Table: CctblMain
.head 3 -  Quest Child Window: cQuickDatabase
.head 3 -  List Box:
.head 3 -  Combo Box:
.head 3 -  Picture: cQuickPicture
.head 3 -  Vertical Scroll Bar:
.head 3 -  Horizontal Scroll Bar:
.head 3 -  Column: CcolDisHideStr
.head 3 -  Background Text:
.head 3 -  Group Box:
.head 3 -  Line:
.head 3 -  Frame:
.head 3 -  Custom Control: cMeter
.head 2 +  Application Actions
.head 3 +  On SAM_AppStartup
.head 4 -  ! Å§2004/10/27Å@Ver.3.30ëŒâû
.head 4 -  Call F_IsCertify( 'PSOPK009' )
.head 4 -  ! Å¢
.head 4 -  !
.head 4 +  ! --TEST------------------------
.head 5 -  ! Set strArgArray[1] = 'THK19I'
.head 5 -  ! Set strArgArray[2] = 'CITIZENTHK'
.head 5 -  ! Set strArgArray[3] = 'CITIZENTHK'
.head 5 -  ! Set strArgArray[4] = 'ADD_CMATUTE(nError,sErrMsg)'
.head 5 -  ! Set strArgArray[5] = 'í ãŒéËìñåvéZ'
.head 5 -  ! Set strArgArray[6] = 'PSSTU200.EXE'
.head 5 -  ! Set strArgArray[7] = ''
.head 5 -  ! Set strArgArray[8] = 'PSKGK150.EXE'
.head 5 -  ! Set strArgArray[9] = '1000'
.head 5 -  ! Set strArgArray[10]= 'PSKGK400.EXE'
.head 4 -  !
.head 4 -  Set SqlDatabase	= strArgArray[1]
.head 4 -  Set SqlUser	= strArgArray[2]
.head 4 -  Set SqlPassword	= strArgArray[3]
.head 4 -  Set sPLSQL	= strArgArray[4]
.head 4 -  Set sTITLE	= strArgArray[5]
.head 4 -  !
.head 4 -  ! Å§2011/02/10
.head 4 -  Set GsPGID 	= strArgArray[0] 
.head 4 -  Set GnAppCnt = F_AutoAppSet()
.head 4 -  ! Å¢2011/02/10
.head 4 -  !
.head 4 -  Set nDebug = 0
.head 4 -  !
.head 4 +  If F_Debug(  )
.head 5 -  Call SalMessageBox( 'ÉfÉoÉbÉOÉÇÅ[ÉhÅI', 'CAUTION',
                     MB_IconExclamation|MB_Ok )
.head 5 -  !
.head 5 -  Set nDebug = 1
.head 4 -  !
.head 4 -  Set sWSID 	= F_GetProfile( 'SYSTEM', 'WS_ID' )
.head 4 +  If sWSID 	=''
.head 5 -  Set sWSID	='WS01'
.head 4 -  !
.head 4 -  ! Å§2011/02/10
.head 4 -  Call F_DBB_Connect( PhSql )
.head 4 -  ! Å¢2011/02/10
.head 4 -  !
.head 4 +  ! If nDebug = 1
.head 5 -       Call SalCreateWindow( frmPL_CALL, hWndNULL )
.head 4 +  ! Else
.head 5 +       If F_GetHandle( hWindowHandle )
.head 6 -  ! Å§ 1999/07/15Å@CenturaëŒâû CreateéûÇÃhWndOwnerÇÃéwíËÉ~ÉXèCê≥
.head 6 -  ! Call SalCreateWindow( frmPL_CALL, hWndNULL )
.head 6 -       Call SalCreateWindow( frmPL_CALL, hWindowHandle )
.head 5 +       Else 
.head 6 -       Call SalSendMsg( hWindowHandle, PAM_SQL, 0, 0 )
.head 6 -       Return FALSE
.head 3 +  On SAM_AppExit
.head 4 -  ! Å§2011/02/10
.head 4 -  Call SqlDisconnect( PhSql )
.head 4 -  ! Å¢2011/02/10 
.head 1 +  Form Window: frmPL_CALL
.head 2 -  Class:
.head 2 -  Property Template:
.head 2 -  Class DLL Name:
.head 2 -  Title:
.head 2 -  Icon File:
.head 2 -  Accessories Enabled? No
.head 2 -  Visible? Yes
.head 2 -  Display Settings
.head 3 -  Display Style? Default
.head 3 -  Visible at Design time? No
.head 3 -  Automatically Created at Runtime? Yes
.head 3 -  Initial State: Normal
.head 3 -  Maximizable? No
.head 3 -  Minimizable? Yes
.head 3 -  Allow Child Docking? No
.head 3 -  Docking Orientation: All
.head 3 -  System Menu? Yes
.head 3 -  Resizable? No
.head 3 -  Window Location and Size
.head 4 -  Left: 1.65"
.head 4 -  Top: 1.222"
.head 4 -  Width:  5.225"
.head 4 -  Width Editable? Yes
.head 4 -  Height: 2.266"
.head 4 -  Height Editable? Yes
.head 3 -  Form Size
.head 4 -  Width:  Default
.head 4 -  Height: Default
.head 4 -  Number of Pages: Dynamic
.head 3 -  Font Name: Default
.head 3 -  Font Size: Default
.head 3 -  Font Enhancement: Default
.head 3 -  Text Color: Default
.head 3 -  Background Color: Default
.head 2 -  Description:
.head 2 -  Named Menus
.head 2 -  Menu
.head 2 +  Tool Bar
.head 3 -  Display Settings
.head 4 -  Display Style? Default
.head 4 -  Location? Top
.head 4 -  Visible? Yes
.head 4 -  Size: Default
.head 4 -  Size Editable? Yes
.head 4 -  Docking Toolbar? No
.head 4 -  Toolbar Docking Orientation: Top | Bottom
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Text Color: Default
.head 4 -  Background Color: Default
.head 3 -  Contents
.head 2 +  Contents
.head 3 +  Pushbutton: pbExe
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: é¿çs(&G)
.head 4 -  Window Location and Size
.head 5 -  Left: 0.838"
.head 5 -  Top: 1.365"
.head 5 -  Width:  1.288"
.head 5 -  Width Editable? Yes
.head 5 -  Height: 0.313"
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Red
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 +  ! Å§2011/02/10 
.head 7 +  ! If SalMessageBox( sTITLE||'èàóùÇçsÇ¢Ç‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©', 'é¿çsämîF', MB_OkCancel | MB_IconQuestion ) = IDOK
.head 8 -  Call SalWaitCursor( TRUE )
.head 8 -  !
.head 8 +  When SqlError
.head 9 -  Call SqlExtractArgs( wParam, lParam, hSqlTemp, nSqlErr,nSqlErrpos )
.head 9 -  Set sSqlErrMsg = SqlGetErrorTextX( nSqlErr )
.head 9 -  Call SqlPrepareAndExecute( hSqlTemp, 'ROLLBACK' )
.head 9 -  ! Call F_SQLErrorMessage( hWndForm, hSqlTemp, sPLSQL , TRUE, 'ÉGÉâÅ|ÇrÇpÇk')
.head 9 -  Call SalMessageBox( sSqlErrMsg,  'ÇrÇpÇkèIóπ',MB_Ok | MB_IconExclamation)
.head 9 -  Call SalSendMsg( pbQuit,SAM_Click, wParam,lParam)
.head 8 -  Call SqlPLSQLCommand( hSqlTemp , sPLSQL )
.head 8 -  !
.head 8 -  Call SalWaitCursor( FALSE )
.head 8 +  If nError = 1
.head 9 -  Call SalMessageBox( sErrMsg, 'èIóπ', MB_Ok | MB_IconAsterisk)
.head 8 +  Else 
.head 9 -  Call SalMessageBox( sErrMsg, 'èIóπ', MB_Ok | MB_IconStop )
.head 8 -  Call SalSetFocus( pbQuit )
.head 6 -  Set bExec = TRUE
.head 6 -  ! åƒÇ—èoÇµpgmÇ™ë∂ç›ÇµÇ»Ç¢èÍçáÇÕÅAPL/SQLé¿çsämîFÉÅÉbÉZÅ[ÉWï\é¶
.head 6 +  If GnAppCnt = 0
.head 7 +  If SalMessageBox( sTITLE||'èàóùÇçsÇ¢Ç‹Ç∑ÅBÇÊÇÎÇµÇ¢Ç≈Ç∑Ç©', 'é¿çsämîF', MB_OkCancel | MB_IconQuestion ) = IDOK
.head 8 -  Call SalWaitCursor( TRUE )
.head 7 +  Else
.head 8 -  Set bExec = FALSE
.head 6 -  ! PL/SQLé¿çs 
.head 6 +  If bExec
.head 7 +  When SqlError
.head 8 -  Call SqlExtractArgs( wParam, lParam, hSqlTemp, nSqlErr,nSqlErrpos )
.head 8 -  Set sSqlErrMsg = SqlGetErrorTextX( nSqlErr )
.head 8 -  Call SqlPrepareAndExecute( hSqlTemp, 'ROLLBACK' )
.head 8 -  Call SalMessageBox( sSqlErrMsg,  'ÇrÇpÇkèIóπ',MB_Ok | MB_IconExclamation)
.head 8 -  ! Call SalSendMsg( pbQuit,SAM_Click, wParam,lParam)
.head 8 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 8 -  Return FALSE
.head 7 -  Call SqlPLSQLCommand( hSqlTemp , sPLSQL )
.head 7 -  !
.head 7 -  Call SalWaitCursor( FALSE )
.head 7 +  If nError = 1
.head 8 +  ! pgmåƒÇ—èoÇµí«â¡
.head 9 -  ! Call SalMessageBox( sErrMsg, 'èIóπ', MB_Ok | MB_IconAsterisk)
.head 8 +  If GnAppCnt > 0
.head 9 -  Set nCnt = 0
.head 9 +  While nCnt < GnAppCnt
.head 10 -  Call F_SetCertifyFlag( GsCallPgid[nCnt] )
.head 10 -  Call F_Create_AccessLog( hSqlTemp, '3', GsUSER, GsAutoApp[nCnt], GsCallPgid[nCnt], GsPGID, 0 )
.head 10 -  Call F_Get_User_A( hSqlTemp, GsUSER , GsUSER)
.head 10 +  If NOT SalLoadAppAndWait( GsAutoApp[nCnt]||' '||SqlDatabase||' '||SqlUser||' '||F_EncodePassword(SqlPassword)||' '||GsAppParam[nCnt], Window_Normal, nRet )
.head 11 -  Call F_Create_AccessLog( hSqlTemp , '4' , GsUSER , GsAutoApp[nCnt], GsCallPgid[nCnt], GsPGID, 0 )
.head 11 -  Call SalMessageBox( GsAutoApp[nCnt]||' ÇãNìÆÇ≈Ç´Ç‹ÇπÇÒÇ≈ÇµÇΩÅBÉvÉçÉOÉâÉÄÇ™ë∂ç›Ç∑ÇÈÇ©ämîFÇµÇƒÇ≠ÇæÇ≥Ç¢ÅB'
, 'PRO_STAFF-Éø ããó^', MB_Ok|MB_IconAsterisk )
.head 10 -  Set nCnt = nCnt + 1
.head 9 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 8 +  Else
.head 9 -  Call SalMessageBox( sErrMsg, 'èIóπ', MB_Ok | MB_IconAsterisk)
.head 7 +  Else
.head 8 -  Call SalMessageBox( sErrMsg, 'èIóπ', MB_Ok | MB_IconStop )
.head 8 +  If GnAppCnt > 0
.head 9 -  Call SalSendMsg( hWndForm, SAM_Close, 0, 0 )
.head 6 -  ! Å¢2011/02/10
.head 6 -  Call SalSetFocus( pbQuit )
.head 3 +  Pushbutton: pbQuit
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Title: èIóπ(&Q)
.head 4 -  Window Location and Size
.head 5 -  Left: 2.988"
.head 5 -  Top: 1.365"
.head 5 -  Width:  Default
.head 5 -  Width Editable? Yes
.head 5 -  Height: Default
.head 5 -  Height Editable? Yes
.head 4 -  Visible? Yes
.head 4 -  Keyboard Accelerator: (none)
.head 4 -  Font Name: Default
.head 4 -  Font Size: Default
.head 4 -  Font Enhancement: Default
.head 4 -  Picture File Name:
.head 4 -  Picture Transparent Color: None
.head 4 -  Image Style: Single
.head 4 -  Text Color: Blue
.head 4 -  Background Color: Default
.head 4 -  Button Appearance: Standard
.head 4 +  Message Actions
.head 5 +  On SAM_Click
.head 6 -  Call SalPostMsg( hWndForm, SAM_Close, 0 , 0)
.head 3 +  Data Field: df1
.head 4 -  Class Child Ref Key: 0
.head 4 -  Class ChildKey: 0
.head 4 -  Class:
.head 4 -  Property Template:
.head 4 -  Class DLL Name:
.head 4 -  Data
.head 5 -  Maximum Data Length: Default
.head 5 -  Data Type: String
.head 5 -  Editable? No
.head 4 -  Display Settings
.head 5 -  Window Location and Size
.head 6 -  Left: 0.038"
.head 6 -  Top: 0.427"
.head 6 -  Width:  4.8"
.head 6 -  Width Editable? Yes
.head 6 -  Height: Default
.head 6 -  Height Editable? Yes
.head 5 -  Visible? Yes
.head 5 -  Border? No
.head 5 -  Justify: Center
.head 5 -  Format: Unformatted
.head 5 -  Country: Default
.head 5 -  Font Name: Default
.head 5 -  Font Size: Default
.head 5 -  Font Enhancement: Default
.head 5 -  Text Color: Blue
.head 5 -  Background Color: 3D Face Color
.head 5 -  Input Mask: Unformatted
.head 4 +  Message Actions
.head 5 -  ! Å•2004/02/24------------------------
.head 5 +  On SAM_Create
.head 6 -  Call SalDisableWindow( hWndItem )
.head 5 -  ! Å£2004/02/24------------------------
.head 2 -  Functions
.head 2 -  Window Parameters
.head 2 +  Window Variables
.head 3 -  Sql Handle: hSqlMain
.head 3 -  Sql Handle: hSqlDele
.head 3 -  Sql Handle: hSqlUpdt
.head 3 -  Sql Handle: hSqlInsr
.head 3 -  Sql Handle: hSqlTemp
.head 3 -  !
.head 3 -  !
.head 3 -  ! SQL¥◊-óp
.head 3 -  Number: nErrFlg
.head 3 -  Number: nSqlErr
.head 3 -  Number: nSqlErrpos
.head 3 -  String: sSqlErrMsg
.head 3 -  !
.head 3 -  Number: nInd
.head 3 -  Number: nError
.head 3 -  String: sErrMsg
.head 3 -  !
.head 3 -  String: sWORK
.head 3 -  !
.head 3 -  ! Å§2011/02/10
.head 3 -  Number: nRet
.head 3 -  Number: nCnt
.head 3 -  Boolean: bExec
.head 3 -  ! Å¢2011/02/10
.head 2 +  Message Actions
.head 3 +  On SAM_Create
.head 4 -  Call SalCenterWindow( frmPL_CALL )
.head 4 -  !
.head 4 -  Call F_DBB_Connect( hSqlMain )
.head 4 -  Call SqlSetParameter(  hSqlMain, DBP_PRESERVE, TRUE, '' )
.head 4 -  Call F_DBB_Connect( hSqlDele )
.head 4 -  Call SqlSetParameter(  hSqlDele, DBP_PRESERVE, TRUE, '' )
.head 4 -  Call F_DBB_Connect( hSqlUpdt )
.head 4 -  Call SqlSetParameter(  hSqlUpdt, DBP_PRESERVE, TRUE, '' )
.head 4 -  Call F_DBB_Connect( hSqlInsr )
.head 4 -  Call SqlSetParameter(  hSqlInsr, DBP_PRESERVE, TRUE, '' )
.head 4 -  !
.head 4 -  Call F_DBB_Connect( hSqlTemp )
.head 4 -  !
.head 4 +  If sPLSQL = ''
.head 5 -  Call SalDisableWindow( pbExe )
.head 5 -  Call SalMessageBox( 'ê›íËÉGÉâÅ[Ç≈Ç∑ÅB', 'ÉGÉâÅ[', MB_Ok )
.head 4 +  Else
.head 5 -  Set df1 = sTITLE ||'èàóùÇçsÇ¢Ç‹Ç∑ÅB'
.head 5 -  Call SalSetWindowText( frmPL_CALL, sTITLE || 'èàóù' )
.head 4 -  !
.head 4 -  ! Å§2011/02/10
.head 4 +  If GnAppCnt > 0
.head 5 -  Call SalHideWindow( frmPL_CALL )
.head 5 -  Call SalSendMsg( pbExe, SAM_Click, 0, 0 )
.head 4 -  ! Å¢2011/02/10
.head 3 +  On SAM_Close
.head 4 -  Call SqlDisconnect( hSqlMain )
.head 4 -  Call SqlDisconnect( hSqlDele )
.head 4 -  Call SqlDisconnect( hSqlUpdt )
.head 4 -  Call SqlDisconnect( hSqlInsr )
.head 4 -  Call SqlDisconnect( hSqlTemp )
.head 4 -  !
.head 4 -  Call SalQuit(  )
.head 1 +  ! ïœçXóöó
.head 2 -  2004/02/24	Data Field:á@DisableÅAáA3D Face Color
.head 2 -  2004/10/27	Ver.3.30ÉZÉLÉÖÉäÉeÉBÅ[ëŒâû
.head 2 -  2007/06/20	É{É^ÉìêFïœçX
.head 2 -  2011/02/10	PL/SQLé¿çså„ÅApgmåƒÇ—èoÇ∑ã@î\Çí«â¡
.head 1 +  ! égópï˚ñ@
.head 2 -  ÉÅÉjÉÖÅ[Ç…åƒÇ—èoÇ∑ÇoÇkñºÇìoò^
ëÊàÍÉpÉâÉÅÅ[É^ÅFåƒÇ—èoÇ∑ÇoÇkñºÅ@ïKÇ∏ïKóvÇ»ÉpÉâÉÅÅ[É^Å@nErrer,sErrMsg
ëÊìÒÉpÉâÉÅÅ[É^ÅFâÊñ É^ÉCÉgÉã
.head 2 -  2011/02/10 í«â¡
ëÊéOÉpÉâÉÅÅ[É^ÅFåƒÇ—èoÇµpgm1
ëÊélÉpÉâÉÅÅ[É^ÅFåƒÇ—èoÇµpgm1ÇÃÉpÉâÉÅÅ[É^
ëÊå‹ÉpÉâÉÅÅ[É^ÅFåƒÇ—èoÇµpgm2
ëÊòZÉpÉâÉÅÅ[É^ÅFåƒÇ—èoÇµpgm2ÇÃÉpÉâÉÅÅ[É^
Å@ÅF
